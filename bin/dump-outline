#!/usr/bin/env perl

use Modern::Perl;
use Path::Tiny;
use FindBin;
use lib "$FindBin::Bin/../lib";

use Language::VimOutliner::AST;

sub main {
	die "Need a filename\n" unless @ARGV;
	my $file = path(shift @ARGV);
	die "File not readable\n" unless -r $file;

	parse($file);
}

sub parse {
	my ($file) = @_;

	my $grammar = Marpa::R2::Scanless::G->new({
		#default_action => '::array',
		default_action => '[name,values]',
		source => Language::VimOutliner::AST->grammar,
	});

	my $recce = Marpa::R2::Scanless::R->new( {
		grammar => $grammar,
		#trace_terminals => 1,
		#trace_file_handle => $trace_fh
		} );

	my $input = $file->slurp_utf8;

	$recce->read( \$input );
	use DDP; p $recce->value;
}


main;
